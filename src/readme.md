# Description

This C++ version is really just C plus namespaces. Namespaces are the only feature of C++ that is used. The Rust version will come later.

First inside a working deirectory build the C++ version of MIRACL core (https://github.com/miracl/core), selecting support for C25519, NIST256, NIST384, RSA2048 and RSA4096.

This library does all the crypto, and can be regarded as a "placeholder" as we may in the future replace its functionality from other sources.

Then copy the contents of this archive to the same directory, in particular client.cpp and tls*.*

Build the client app by 

	g++ -O2 client.cpp tls_keys_calc.cpp tls_sockets.cpp tls_hash.cpp tls_scv.cpp tls_cert_chain.cpp tls_parse_octet.cpp tls_client_recv.cpp tls_client_send.cpp core.a -o client

Then execute the client process as for example

	./client mail.protonmail.com

The output should look something like

	Hostname= mail.protonmail.com
	ip= 185.70.41.130
	Private key= 0x0ecb087899f31063f056957c994b26bb07ba211ab450002160edf53f563648c2
	Client Public key= 0x77810738db533b33b60f049b7f351bbbb260a83b1eab0619862696655ff19d21
	Client to Server -> 16030100c6010000c2030360223e3baff85a23ad4dd41cbad832b6930d0c5a955fb689c0e6e77b946a71fe200bf65a3a1b2e47e8cd58882df8935faf8df808d5c5d4fff92baa638c148cd82b000413011302010000750000001800160000136d61696c2e70726f746f6e6d61696c2e636f6d000a00080006001d00170018000d0012001004030804040105030805050108060601003300260024001d002077810738db533b33b60f049b7f351bbbb260a83b1eab0619862696655ff19d21002d00020101002b0003020304
	Client Hello sent
	Server Random= 2d31a9ae80239647a16887c6af7df9bd6b4be042f185e13f889f7780c6ec69b0
	Cipher suite= 1302
	tls version= 0304
	Key Share = 001d
	Server Public Key= b457ab7a3952693fd08afca2d6b335a91532cc7aef9866289dc841e38ad0b32d
	Server Hello= 122 0200007603032d31a9ae80239647a16887c6af7df9bd6b4be042f185e13f889f7780c6ec69b0200bf65a3a1b2e47e8cd58882df8935faf8df808d5c5d4fff92baa638c148cd82b130200002e002b0002030400330024001d0020b457ab7a3952693fd08afca2d6b335a91532cc7aef9866289dc841e38ad0b32d
	X25519 Key Exchange
	Shared Secret= 219a984b56dd0c3a9ce307b72ff0eedc652b784c008dc5607faae1c116fc9832
	Handshake Secret= ae619d8a9cb5eb8c1634dd7e7adb41a1cca493160a21fd2b42fe7d634894eb0de262b71226c3a3ac47e4db544a7a26a9
	Client handshake traffic secret= 9dce724e51e9aa7436b55c04c63f6380b8a949a8b931bef4535cf3d5057f231aeddfde3ab3da32cad498a8f180a404a8
	Server handshake traffic secret= b6f723761a0cefab05982f9997bb151ed2ec2246c8cd0c6a8f6817aa6c31b29f9f9fbba9a2fe839ecabbbb4d8cdb4d5c
	Server fragment authenticates 11
	Length of Encrypted Extension= 6
	Server fragment authenticates 4468
	1. Transcript Hash= f4f4fb72379e4f27895cad6e072655431ae3ecf2fa2486db1fa870ca26b6acdd44ca8e652f73e66ef8bb140b16f911b9

	Server certificate
	Signature is aa5e32911a921beada411b7cbb41618006986082432d5356b2b0605a23a652fde14dfc8984286e2ae2641f84037007b6841322b669cb5ae2a193ccf23d565a98819636a353ed3ba6c19ef65395f83855af241f81bd7c20079adf468c7bbbd71c15bc6777786bc6efc9c045e2895f9e176fdf52e095b14c9cf46fdc5ca9ece1ebd2b72d91f45c09cae00aaa199814670b63595493b2bb4053e7d14fd63aec3eb2936165a8e7839a11034c82972945d02989d8206f676d1bcf5b0791420fbf605b717aa1ddd7bcece9fa6515da4f89d04f36b8a2d575f4ae22752c90907de93c46f5a1ca9da7d8bde4634cfefaa16b3d38c46c5398bb9d77f23f9c575b5a88d5fa
	RSA signature of length 2048
	Public key= 512 c8629daafe74555500468234df387c619792bf9d84720c1964b2b4be04c34a69a8afd5780d1272ea06149c5fca0ef262aadd15a0038e66bf1306d703ad2dd9aa5381f6a3e6e8f2b481f8844458edc5a4d1439de2b62ccb12597c2d76637b22dee4d328a5a4711cef4d8b6f4a53d62d08c887afc51a43415ebc6447c46319ba2cf07d0beba104e6a919093ad3feb9cb09f1e00b65211aabdb59ce7f8719c3951b84909655bdb0e23aaa2a0328f27fd5a69383035240e57218a6f550d4417b6ee08b26d922da3ae4ac7a5428eef64d4eac5c0e36113a4164f48fc5b1982a837bb837c9538eb378ab0ec5676b625b9970da94d3a42f34df7b977bd0b9a15b3dfedc9bda2464df4d100f93fbcf45b9182d2b85ebe6a06b459d3655ddfdfd817c3de0e4c797e39ac22590edbec86fe70c7fdb078ad0fa0f372eb0d56be7cad26757adb65131bb9added44af4713700b6949034f1a367972c73c5387d2e8b3c9c6537e56d8e0f7859caaa174cd4167871bc8f034fcfabc55637655eb027e93bb94dc1387b997f4d3c64e2e314e6037d3e494052d515c00581b0ed3ebf85b97b15107a7e36848859b9f1f7d283678e1a8c597c4d26c46ea5755f6dde13c232781de6b185590e48555de9777937154c91a1e675ee711e8451608f81aec36e4376a581b9cdff39cf3a109954cc77e66dc332e6014ad33ab400c6d2bb3893dc051ff6dbda7
	RSA public key of length 4096
	Issuer is  SwissSign EV Gold CA 2014 - G22
	Subject is protonmail.com

	st.curve= 2048
	SIG= 256
	aa5e32911a921beada411b7cbb41618006986082432d5356b2b0605a23a652fde14dfc8984286e2ae2641f84037007b6841322b669cb5ae2a193ccf23d565a98819636a353ed3ba6c19ef65395f83855af241f81bd7c20079adf468c7bbbd71c15bc6777786bc6efc9c045e2895f9e176fdf52e095b14c9cf46fdc5ca9ece1ebd2b72d91f45c09cae00aaa199814670b63595493b2bb4053e7d14fd63aec3eb2936165a8e7839a11034c82972945d02989d8206f676d1bcf5b0791420fbf605b717aa1ddd7bcece9fa6515da4f89d04f36b8a2d575f4ae22752c90907de93c46f5a1ca9da7d8bde4634cfefaa16b3d38c46c5398bb9d77f23f9c575b5a88d5fa

	RSA PUBLIC KEY= 256
	bf8c56ed74921d39e4c50892945a0bbb1f8ae150e2001816fe01e4b7ec2ba352a53689c9b62fac0fe5af424113fc53b1097726b91aeb4160a6b4a1f695e013de1456813641be0b887128008632050634680de72fd184913e37eae5ecd2d57655e83afba0a0191ce06a842d0eede15d657918ec8d380b659b347899dd491faa056a9f5dde457024b131508f77d02c23cf0b745c072f8f2f3e7cb85e05a9c6e551469d1ae7b51496891cd84088e30240434e2fa58f9e7687d68acc5bc5110e4d4a2066ac6564db0225ae1f8065ef0d6275eb441cefd19e523830f88f1c8f913017edff73909f6cd323151266a55a77f05e7e0ae11cf7c7b7e659ecb18a950e8529
	Checking RSA Signature on Cert 32
	RSA Signature/Verification succeeded
	Intermediate Certificate Chain sig is OK

	Intermediate Certificate
	Signature is 25718548309ec159804982e74702304c5c9af63d39090fc5c41b30c14262f7ef045373eb98aed0c9174e8d2385a21ef3038eb2fdb7d2aff36096d364e19b329bd48393114482bd0c2ab76c3c00a8df5b223170c0ad5b383b76eb49bdfb880bc4925db76307e4b020950d89d35db7f91a1d631befddbfb993afc3675f5d254817ae36c3fb43d6b8ee7ee4345a9e0a775442c84568c70009e99aade0b8e4622ee5434be3e88a7169fc2284151860588869eac65dc80ffd7a03be647f94ecaccb68cb9844d1df26bd94ae041412e7ec38cd1652a4174bc4733bb6465bf6ab81fc9ce0d7520a2bcef7bc5906ba0e3745da2ce9530006ee6e89a1cf3fcafd4bf64b94fe23f01f6160a67bb571fcac9e03d89ffde2c08d0367e6521bd5c5e1a26a4cd8cfa42c01a336176942f51292302128e933a1e7b324437e4575383f9b4e271c34dcbb4957199d431430817391d2b0594fef5a149497d67223ef35919ccc05bb9c3e801697d7fe4cb8b3ff4e1242724a1581bd289db14b467eac887e9d344fa067956088c59e0ce930951d5431618c370a0a344c684ca6302a7a6e31fbf8abb171e2e23da95cc64cbeb27d6f3e49177154541ae8af617a406bda467200a042ab3fa3a50ab510f09cbe7e0788dc7cd4d6befa2a9e2be77699f671744b80c05a1921cca4d5a4d61c74f50aacf2b34d3096e92f4a69d75016c6539569c338e58f7378
	RSA signature of length 4096
	Public key= 256 bf8c56ed74921d39e4c50892945a0bbb1f8ae150e2001816fe01e4b7ec2ba352a53689c9b62fac0fe5af424113fc53b1097726b91aeb4160a6b4a1f695e013de1456813641be0b887128008632050634680de72fd184913e37eae5ecd2d57655e83afba0a0191ce06a842d0eede15d657918ec8d380b659b347899dd491faa056a9f5dde457024b131508f77d02c23cf0b745c072f8f2f3e7cb85e05a9c6e551469d1ae7b51496891cd84088e30240434e2fa58f9e7687d68acc5bc5110e4d4a2066ac6564db0225ae1f8065ef0d6275eb441cefd19e523830f88f1c8f913017edff73909f6cd323151266a55a77f05e7e0ae11cf7c7b7e659ecb18a950e8529
	RSA public key of length 2048
	Issuer is  SwissSign Gold CA - G2
	Subject is SwissSign EV Gold CA 2014 - G22


	Public Key from root CA cert= afe4ee7e8b240e126ea9502d16443b92925ccab85d849242132abc655782403e5724cd508b252ab76ffcefa2d0c01f02244a13968f2313e6285800a347c706a784232bbbbd962b7f55cc8bc1571f0e62650fdd3d568a73daae7e6dba811c7e428c2035d9434d84fa84db522cf30e27770b6bbf112f72789f2ed83ee618375a2a72f9da62909295ca1f9ce9b33c2bcbf30113bf5acfc1b50a60bdddb5996453b8a096b36fe22677918ce06210029f340fa4d5923351debe8dba847a603c6adb9f2becdede013f6e4de55086cbb4afed4440c5ca5a8cdad22b7ca8eebea6e50aaa0ea5df0552b755c7225d326a97976313dbc9db79367b853a4ac55289f924e79d77a982ff551ca571692bd10224f2b326d46bda0455e5c10ac76d3037902ae49e14335e161755c55bb5cb348992f19d268fa107d4c6b27850db0c0c0b7c0b8c41d7b9e9dd8c88f7a34db232ccd817dacdb7ce669dd4fd5effbd973e2975e77ea76258af2534a541c73dbc0d50ca03030f085a1f95737862bfaf7214690ea5e5030e788e262842f0070b622010673946faa903cc04387a66ef2083b58c4a568e9100fc8e5c82de88a0c3e2686e7d8def3cdd65f45dac51ef2480aeaa56976ff9ad7dda613f98773ca591b61c8c26da65a2096dc1e254e3b9ca4c4c808f777b609a1edfb6f2481e0eba4e546d98e0e1a21aa27750cfc46392ec47199debe66bcec1
	st.curve= 4096
	SIG= 512
	25718548309ec159804982e74702304c5c9af63d39090fc5c41b30c14262f7ef045373eb98aed0c9174e8d2385a21ef3038eb2fdb7d2aff36096d364e19b329bd48393114482bd0c2ab76c3c00a8df5b223170c0ad5b383b76eb49bdfb880bc4925db76307e4b020950d89d35db7f91a1d631befddbfb993afc3675f5d254817ae36c3fb43d6b8ee7ee4345a9e0a775442c84568c70009e99aade0b8e4622ee5434be3e88a7169fc2284151860588869eac65dc80ffd7a03be647f94ecaccb68cb9844d1df26bd94ae041412e7ec38cd1652a4174bc4733bb6465bf6ab81fc9ce0d7520a2bcef7bc5906ba0e3745da2ce9530006ee6e89a1cf3fcafd4bf64b94fe23f01f6160a67bb571fcac9e03d89ffde2c08d0367e6521bd5c5e1a26a4cd8cfa42c01a336176942f51292302128e933a1e7b324437e4575383f9b4e271c34dcbb4957199d431430817391d2b0594fef5a149497d67223ef35919ccc05bb9c3e801697d7fe4cb8b3ff4e1242724a1581bd289db14b467eac887e9d344fa067956088c59e0ce930951d5431618c370a0a344c684ca6302a7a6e31fbf8abb171e2e23da95cc64cbeb27d6f3e49177154541ae8af617a406bda467200a042ab3fa3a50ab510f09cbe7e0788dc7cd4d6befa2a9e2be77699f671744b80c05a1921cca4d5a4d61c74f50aacf2b34d3096e92f4a69d75016c6539569c338e58f7378

	RSA PUBLIC KEY= 512
	afe4ee7e8b240e126ea9502d16443b92925ccab85d849242132abc655782403e5724cd508b252ab76ffcefa2d0c01f02244a13968f2313e6285800a347c706a784232bbbbd962b7f55cc8bc1571f0e62650fdd3d568a73daae7e6dba811c7e428c2035d9434d84fa84db522cf30e27770b6bbf112f72789f2ed83ee618375a2a72f9da62909295ca1f9ce9b33c2bcbf30113bf5acfc1b50a60bdddb5996453b8a096b36fe22677918ce06210029f340fa4d5923351debe8dba847a603c6adb9f2becdede013f6e4de55086cbb4afed4440c5ca5a8cdad22b7ca8eebea6e50aaa0ea5df0552b755c7225d326a97976313dbc9db79367b853a4ac55289f924e79d77a982ff551ca571692bd10224f2b326d46bda0455e5c10ac76d3037902ae49e14335e161755c55bb5cb348992f19d268fa107d4c6b27850db0c0c0b7c0b8c41d7b9e9dd8c88f7a34db232ccd817dacdb7ce669dd4fd5effbd973e2975e77ea76258af2534a541c73dbc0d50ca03030f085a1f95737862bfaf7214690ea5e5030e788e262842f0070b622010673946faa903cc04387a66ef2083b58c4a568e9100fc8e5c82de88a0c3e2686e7d8def3cdd65f45dac51ef2480aeaa56976ff9ad7dda613f98773ca591b61c8c26da65a2096dc1e254e3b9ca4c4c808f777b609a1edfb6f2481e0eba4e546d98e0e1a21aa27750cfc46392ec47199debe66bcec1
	Checking RSA Signature on Cert 32
	RSA Signature/Verification succeeded
	Root Certificate sig is OK!!!!
	Certificate Chain is valid
	Server fragment authenticates 521
	2. Transcript Hash= fd9b0fece7e0aa7b524fb8f93ed0e264cc1aa89bf5560359244471223d538445720cd161e0f2f58e33b9775be3803215
	Signature Algorithm= 0804
	Server Certificate Signature= 512 4f16b7ab40daf46457ba38aa0a4a3f5f6a001d1d97a45cec44d6c30512637e9ca0f98d9c3fe26f2aff8ecaff66a0aa024eb08c4d12284af9533984a595b8dbfa45e09bd2e3e485104ee889769f16118b31572273b8f71b0329cb61eeac4eae84560c237acd78c43a68a59c4bb9f182777a27960e7be93e690abe7eb6c932c022dbbd02c6cd6eb578cbfb882579cdc4d4aa07fae2c3be60df4a9a986751a62ebcc8fe0fda504c86f6b6bf7c9d1621466b44666fe884650492ff1643c14d8c6cdd7f688fc5554af424225f51de1f5dc5c43ba9d332180d406f9606d5cddfbb91f77380cf6022ca10be30e9d7b24dbbc40d63cd067ed1ef352827551b6c8cc9f4974ab459d1bdf87653142571f7315c1d766e133bb75a4b8df0eb45ba6ab45627d259445b4ef01c29ea5b031df8013a123b6c0a45726b570efbc9630ea92de9f3e34946c9d4af362eaf40c8671d25142e611fabc0c269b28e6f40379f68b21bd1fe70c82e7257441f83f12d29d49fe3feacc1a914fa7e8ae948d3a9e7c0bf290b0bce7bfd9368005501b013b559001beda3448c14540d045c6e56158169153d1542e7fe0a7dc6f16ecd7293fba38987e9a5a59e013e5363d83720cce5efba4b8e160195cc64c926ff34fe6bca21a989b02adaa774b0d7defb5b70f393272ca52c2dffca9148da9b226a5f7e2b52598e931793852f351bd9e6feaa14500013f7b8ab
	Server Cert Verification OK
	Server fragment authenticates 53
	3. Transcript Hash= d02c50888234411dfc2dd82d6dfec8d5596761e6be60ecfe66e971c8507cde4c5e6c59b43896c00296205bb90ea6ef7d
	Server Data is verified
	Client Verify Data= def7ce3f10038ca72842044c5a5a0762411202621dcfed9923e8a847788a5cbbf5bba5500f13d556d97b63c65df6f6e9
	Client to Server -> 1703030045a4b78b8b40016eda7c748b627b4d1d6c1bedb97c2e95ffaea27127810ab2ade6340d88c6fc63c42ac067a2c0294dac265c2652584784182812a95600b2252595c3f5c0c907
	Client application traffic secret= bceed5eceec35b6a1ce3a31f1ef2b740e987c59c61086db3ba41cbebd62e6cac0b8f3e3e8ab062071319e554434f4ae6
	Server application traffic secret= 779f62c7c1c80512f089789b54ea006a277c21bdbd1597ca1145840771376a4a58666d3a159c4fa30435eda0514b894b
	Sending Application Message

	GET / HTTP/1.1
	Host: mail.protonmail.com

	Client to Server -> 170303003e0b3121ff85432df301f35537350c703678457819864e5b79f9980117c27f503fe6b2f9a8713baa54a5d0f582ac64d62832ea1b0276a7e6a1c13d0d3f1ea5
	Waiting for Server input
	Server fragment authenticates 58
	Got a ticket
	Waiting for Server input
	Server fragment authenticates 58
	Got a ticket
	Waiting for Server input
	Server fragment authenticates 4878
	Application data (truncated HTML) = 485454502f312e3120323030204f4b0d0a646174653a205475652c203132204a616e203230323120
	Waiting for Server input
	TIMEOUT
	Connection closed

	Connection re-opened - attempting resumption
	Ticket= 00001c2015574665080000000000000001002031ab651389d81092d7dae904f587d2794feb605f4e8db803c2d9dee3dc59d5870000
	Ticket details
	life time t= 120 minutes
	Age obfuscator = 15574665
	Nonce = 0000000000000001
	Ticket = 32 31ab651389d81092d7dae904f587d2794feb605f4e8db803c2d9dee3dc59d587
	PSK= c2b47deed582d47465c04965346754813958eb7293b398836384129a3f50c6352c710c5b93c67a178f3226b7a864af89
	Binder Key= 48 218758316aa4814bd181e25fef5dc95a2bd6d4a3b62e0d78d551b91b66cdf4b0d4ef9759f92eaafdfc4d2fd75cd35312
	Private key= 0x0a5716f7fee0430a6fa3d1f3b8f5663e2438a4ca17bc396b6b6aaf1eea27481f
	Client Public key= 0x8e8b4ceb4d2981c82e993e97f7e0084fde66e3802e4156d69ba146358e3b0804
	Client to Server -> 16030300f20100012103031d3ad609a13d57fd40bbdb970e34a3c44de5ccba44ca43d747b49aa07b5d893120bdf447d94c535f059a8df3dc0751e230c1c61a92590bfbfe5a30dbb4514b1214000413011302010000d40000001800160000136d61696c2e70726f746f6e6d61696c2e636f6d000a00080006001d00170018000d0012001004030804040105030805050108060601003300260024001d00208e8b4ceb4d2981c82e993e97f7e0084fde66e3802e4156d69ba146358e3b0804002d00020101002b00030203040029005b0026002031ab651389d81092d7dae904f587d2794feb605f4e8db803c2d9dee3dc59d58715576d75
	Client Hello sent
	BND= 0c7c0aebd1fbba862af55ba3a5502ee9e22719dbb6dfc27e8b0e7fc6c43ba1854dfce3f234a551b49605dbcfc76c8c25
	Sending Binders
	Client to Server -> 16030300330031300c7c0aebd1fbba862af55ba3a5502ee9e22719dbb6dfc27e8b0e7fc6c43ba1854dfce3f234a551b49605dbcfc76c8c25
	Server Random= b9edd0d0ff6cada71368f0e5bf42a13b033ca623bb67cbf2a4790f9a89a7e29c
	Cipher suite= 1302
	tls version= 0304
	Key Share = 001d
	Server Public Key= d0006b6c8a55a5624c496bd3928b254d2a6aea843819e902dae321a39d969954
	PSK ID= 0
	serverHello= 128 0 0200007c0303b9edd0d0ff6cada71368f0e5bf42a13b033ca623bb67cbf2a4790f9a89a7e29c20bdf447d94c535f059a8df3dc0751e230c1c61a92590bfbfe5a30dbb4514b12141302000034002b0002030400330024001d0020d0006b6c8a55a5624c496bd3928b254d2a6aea843819e902dae321a39d969954002900020000
	X25519 Key Exchange
	Shared Secret= 85833db8a11709458ab4cf14a908ccba6917a3ac46703b47239652e1ca3bbc67
	Handshake Secret= 7243f93a71a9b8ed632bd242414eac09588eb52cf9454f8d2aaf4df4e3d88766e2b604c68f1f2c75d47c375aafe245c1
	Client handshake traffic secret= 0d585f6567badbc0a55b8040300f927370fc0cab2a2960b44464e7c04b7c02b7faacfd73523e56adc2635e78e4fcc3cc
	Server handshake traffic secret= a52bbb4d566a9846ab80c61bc8aae3ba87c60f103e2ad6606966fc65ffa607227136ce3ebf50c9500f58f65a4ab85192
	Server fragment authenticates 11
	Length of Encrypted Extension= 6
	2. Transcript Hash= 6791e40df3dd7715fb6d028ca4e5cc1dd359af4a77bd52d266e6948a136b3e0b8846668658708ba1e3f04ec74a894007
	Server fragment authenticates 53
	3. Transcript Hash= 3e347ed9a407a71e812177cf85717331c00c6a0487b8e1333c537d5f830fe1df30f8b865e35f23599f6211fa7a02933b
	Server Data is verified
	Client Verify Data= 4e01f3df8f960afb9f9f25be3a2d2df2ef5a2091837271ca561903003813d97c0ad99ea18c86a157624fb4f33794c3ac
	Client to Server -> 1703030045fd4a1add95ffea4a64515ae620778ad8fdd62e82df1959eef8181bed0386bfcade8eead23bd878158e859d19972ad265843d4f769fa147b0eaff7a298788e36b417c7bc42b
	Client application traffic secret= 730fb4127f50e5be5212718ac67f04e87402e4309d9fcc2d3ed2b7d3a1c0a163c2b075b21b8194f1b6828ddcae958c23
	Server application traffic secret= 66772ce18abbb54823fd0fc3ec5f1d669dd7baf4cf1f653b04e07057a0612dd03f8de1c6f3b39f016f44ae35a371e4a6
	Sending Application Message

	GET / HTTP/1.1
	Host: mail.protonmail.com

	Client to Server -> 170303003ef7bcb4429dde8b897200229335a80c16e7766788146e215e9f459199113e8f00d436151651d8c2631f58492fa069e9d4cef6b85a475684e4a3d07cf17d6c
	Waiting for Server input
	Server fragment authenticates 58
	Got a ticket
	Waiting for Server input
	Server fragment authenticates 4878
	Application data (truncated HTML) = 485454502f312e3120323030204f4b0d0a646174653a205475652c203132204a616e203230323120
	Waiting for Server input
	TIMEOUT

Try it out on your favourite websites. It will abort if TLS1.3 is not supported. 
At this stage the tool is still quite fragile (only tested and debuggd aginst a dozen websites or so!), and would be expected to often fail.

In particular try

	./client tls13.1d.pw

Try it a few times - it randomly asks for a HelloRetryRequest and a Key Update, testing this code (but it does not allow resumption)
